# Firebase テストデータ削除ガイド

## 📋 概要

正式公開前に、Firestore上のテストデータ（テスト公園・レビュー）を削除するためのガイドです。

---

## 🎯 削除対象のデータ

### 1. テスト公園データ (parksコレクション)
- SAMPLE_DATA.jsに記載されているサンプル公園
  - 中央公園
  - 桜の森公園
  - こどもの森公園
  - 水と緑の広場
  - 展望台公園

### 2. テストレビュー (reviewsコレクション)
- サンプルユーザーによる投稿レビュー

### 3. テストユーザーデータ
- お気に入り (favoritesコレクション)
- 報告 (reportsコレクション)
- ブロックユーザー (blockedUsersコレクション)

---

## 方法1: Firebase Consoleから手動削除（推奨）

### ステップ1: Firebase Consoleにアクセス

1. [Firebase Console](https://console.firebase.google.com/) にアクセス
2. `ParkPedia` プロジェクトを開く
3. 左メニューから「Firestore Database」を選択

### ステップ2: parksコレクションの確認

1. `parks` コレクションをクリック
2. テストデータのドキュメントを特定：
   - **名前で特定**: 「中央公園」「桜の森公園」など
   - **住所で特定**: 「東京都千代田区丸の内1-1-1」など架空の住所
   - **userId**: `sample-user-id-*` で始まるID

### ステップ3: テスト公園を削除

各テストドキュメントに対して：

1. ドキュメントをクリック
2. 右上の「⋮」（3点メニュー）をクリック
3. 「ドキュメントを削除」を選択
4. 確認ダイアログで「削除」をクリック

**⚠️ 注意**: 本物のユーザーが投稿した公園は削除しないでください！

### ステップ4: reviewsコレクションの確認と削除

1. `reviews` コレクションをクリック
2. テストレビューを特定：
   - **userName**: 「田中太郎」「佐藤花子」などサンプル名
   - **userId**: `sample-user-id-*` で始まるID
3. 各テストレビューを削除（手順は公園と同じ）

### ステップ5: その他のコレクションの確認

以下のコレクションもチェックして、テストデータがあれば削除：

- **favorites**: `sample-user-id-*` のユーザーIDを持つドキュメント
- **reports**: テストデータに関連する報告
- **blockedUsers**: テストユーザーのブロック情報

---

## 方法2: スクリプトで一括削除（データが多い場合）

テストデータが大量にある場合は、スクリプトで一括削除できます。

### ステップ1: 削除スクリプトの実行

プロジェクトディレクトリで以下のコマンドを実行：

```bash
cd /Users/yoshidometoru/Documents/GitHub/ParkPedia
node scripts/deleteTestData.js
```

### ステップ2: 削除対象の確認

スクリプトが削除対象のデータをリストアップします。内容を確認してください。

### ステップ3: 削除の実行

確認後、`y` を入力して削除を実行します。

---

## ✅ 削除後の確認

### 1. Firebase Consoleで確認

各コレクションを開いて、テストデータが削除されたことを確認：

- [ ] `parks` コレクション: サンプル公園が削除されている
- [ ] `reviews` コレクション: サンプルレビューが削除されている
- [ ] `favorites` コレクション: テストユーザーのお気に入りが削除されている

### 2. アプリで確認

1. アプリを起動
2. ホーム画面で公園リストを確認
3. サンプル公園（中央公園、桜の森公園など）が表示されないことを確認
4. 本物のユーザーが投稿した公園のみが表示されることを確認

---

## ⚠️ 重要な注意点

### 削除してはいけないもの

以下は**絶対に削除しないでください**：

1. **本物のユーザーが投稿した公園**
   - 実在する公園名
   - 実際のユーザーIDを持つ公園

2. **本物のユーザーのレビュー**
   - 実際のユーザーが投稿したレビュー
   - リアルなコメントや評価

3. **Firebase Authenticationのユーザーアカウント**
   - テストユーザーアカウント（`reviewer@parkpedia.test`など）を除く
   - 本物のユーザーアカウントは削除しない

### バックアップの推奨

万が一のため、削除前にデータをエクスポートすることを推奨します：

1. Firebase Console > Firestore Database
2. 「エクスポート」ボタンをクリック
3. Cloud Storage バケットを選択
4. エクスポートを実行

---

## 🔍 テストデータの見分け方

### テストデータの特徴

以下の特徴があれば、テストデータの可能性が高いです：

1. **userId が sample-user-id-* で始まる**
   ```
   sample-user-id-1
   sample-user-id-2
   ```

2. **公園名がサンプルデータと一致**
   - 中央公園
   - 桜の森公園
   - こどもの森公園
   - 水と緑の広場
   - 展望台公園

3. **住所が架空**
   - 東京都千代田区丸の内1-1-1
   - 東京都港区六本木1-1-1
   - （末尾が1-1-1の架空住所）

4. **レビュー投稿者名がサンプル**
   - 田中太郎
   - 佐藤花子
   - 鈴木一郎
   - など

### 本物のデータの特徴

以下の特徴があれば、本物のユーザーデータです：

1. **userId が Firebase Auth の実際のUID**
   - 英数字のランダムな文字列（例: `xYz9AbC123dEf456`）

2. **公園名が実在する公園**
   - Googleマップで検索できる公園

3. **住所が実在する**
   - 実際の住所

4. **レビューのコメントがリアル**
   - 実際の体験に基づくコメント

---

## 📞 トラブルシューティング

### 問題1: どれがテストデータか分からない

**解決方法:**
1. SAMPLE_DATA.jsファイルを参照
2. 公園名、住所、userIdを照合
3. 不明な場合は削除しない（安全第一）

### 問題2: 削除権限がない

**解決方法:**
1. Firebase Consoleで、自分のアカウントに「編集者」または「オーナー」権限があるか確認
2. 権限がない場合は、プロジェクトオーナーに依頼

### 問題3: 誤って本物のデータを削除してしまった

**解決方法:**
1. バックアップがあればリストア
2. バックアップがない場合、削除したデータは復元できません
3. ユーザーに再投稿を依頼

---

## ✨ 削除完了後

テストデータの削除が完了したら：

1. [ ] アプリで動作確認
2. [ ] TestFlightで最終確認
3. [ ] App Storeに提出
4. [ ] 正式リリース 🎉

---

## 📝 チェックリスト

削除作業のチェックリスト：

- [ ] Firebase Consoleにログイン完了
- [ ] parksコレクションのテストデータを確認
- [ ] テスト公園を削除完了（5件）
- [ ] reviewsコレクションのテストレビューを確認
- [ ] テストレビューを削除完了
- [ ] favoritesコレクションを確認
- [ ] テストユーザーのお気に入りを削除完了
- [ ] reportsコレクションを確認（必要に応じて）
- [ ] blockedUsersコレクションを確認（必要に応じて）
- [ ] アプリで動作確認完了
- [ ] 本物のユーザーデータが残っていることを確認

---

**最終更新**: 2025年12月4日

**お疲れ様でした！これでアプリが正式公開の準備が整いました！** 🎊
