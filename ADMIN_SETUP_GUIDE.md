# 管理者ページ セットアップガイド

## 📋 概要

管理者ページを実装しました。妻とあなたで管理できるようになっています。

## 🔧 セットアップ手順

### 1. Firestoreに管理者コレクションを作成

Firebase Consoleで以下の手順を実行してください：

1. **Firestore Database**を開く
2. **コレクションを開始**をクリック
3. コレクションID: `admins` を入力
4. 最初のドキュメントを作成：
   - **ドキュメントID**: あなたのFirebase Authentication UID（例: `abc123xyz...`）
   - **フィールド**: 
     - `userId` (文字列): あなたのFirebase Authentication UID（ドキュメントIDと同じ）
     - `email` (文字列): あなたのメールアドレス（オプション）
     - `createdAt` (タイムスタンプ): 現在の日時
5. **保存**をクリック

6. 妻のアカウントも追加：
   - **ドキュメントを追加**をクリック
   - **ドキュメントID**: 妻のFirebase Authentication UID
   - **フィールド**:
     - `userId` (文字列): 妻のFirebase Authentication UID
     - `email` (文字列): 妻のメールアドレス（オプション）
     - `createdAt` (タイムスタンプ): 現在の日時
   - **保存**をクリック

### 2. Firebase Authentication UIDの確認方法

1. アプリでログイン
2. マイページを開く
3. メールアドレスが表示されていることを確認
4. Firebase Console > Authentication > Users でUIDを確認
   - または、アプリのデバッグログで `auth.currentUser.uid` を確認

### 3. Firestoreルールを更新

`firestore.rules`ファイルの内容をFirebase Consoleにコピー＆ペーストしてください：

1. Firebase Console > Firestore Database > ルールタブ
2. `firestore.rules`の内容をコピー
3. ルールエディタに貼り付け
4. **公開**をクリック

## 🎯 管理者ページの機能

### レポート管理
- ユーザーから報告されたレビューを確認
- レポートの状態を「解決済み」「却下」に変更
- 不適切なレビューを削除

### 公園管理
- すべての公園を一覧表示
- 不適切な公園を削除（関連レビューも削除）

### レビュー管理
- すべてのレビューを一覧表示
- 不適切なレビューを削除（公園の評価も自動更新）

## 📱 アクセス方法

1. アプリでログイン
2. マイページを開く
3. **🔧 管理者ページ**ボタンをタップ
   - 管理者権限がある場合のみ表示されます

## 🔒 セキュリティ

- 管理者権限はFirestoreの`admins`コレクションで管理
- Firestoreルールで管理者のみがレポートの更新・削除が可能
- 一般ユーザーは自分のレポートのみ閲覧可能

## ⚠️ 注意事項

- 管理者UIDは慎重に管理してください
- 管理者ページから削除したデータは復元できません
- レビューを削除すると、公園の評価が自動的に再計算されます

## 🐛 トラブルシューティング

### 管理者ページが表示されない

1. `admins`コレクションにあなたのUIDが登録されているか確認
2. アプリを再起動
3. ログアウトして再度ログイン

### レポートが表示されない

1. Firestoreルールが正しく公開されているか確認
2. 管理者権限が正しく設定されているか確認

### 削除ができない

1. Firestoreルールで管理者権限が正しく設定されているか確認
2. ネットワーク接続を確認

---

**最終更新**: 2025-12-07

