# Firebase テストデータ手動削除 - 詳細手順書

## 📋 概要

Firebase Consoleから直接テストデータを削除する、ステップバイステップのガイドです。

---

## 🎯 削除する前に確認すること

### ⚠️ 非常に重要な注意事項

1. **本物のユーザーデータを削除しないでください**
   - 実在する公園
   - 実際のユーザーが投稿したレビュー
   - 本物のユーザーのお気に入り

2. **削除は取り消せません**
   - 一度削除したデータは復元できません
   - 不安な場合は、削除せずにスキップしてください

3. **慎重に確認しながら進めてください**
   - 各ステップで内容を確認
   - 不明なデータは削除しない

---

## ステップ1: Firebase Consoleにアクセス

### 1-1. ブラウザでFirebase Consoleを開く

1. ブラウザ（Chrome、Safari など）を開く
2. 以下のURLにアクセス：
   ```
   https://console.firebase.google.com/
   ```

3. Googleアカウントでログイン
   - ParkPediaプロジェクトの権限があるアカウントでログインしてください

### 1-2. ParkPediaプロジェクトを開く

1. Firebase Consoleのホーム画面が表示されます
2. プロジェクト一覧から **「ParkPedia」** または **「parkpedia-app」** を探す
3. プロジェクト名をクリック

---

## ステップ2: Firestoreにアクセス

### 2-1. Firestore Databaseを開く

1. プロジェクトのダッシュボードが表示されます
2. 左側のサイドバーメニューを見てください
3. **「ビルド」** セクションを展開（既に展開されている場合はそのまま）
4. **「Firestore Database」** をクリック

### 2-2. Firestoreの画面が表示される

以下のような画面が表示されます：

```
┌─────────────────────────────────────────────────┐
│ Firestore Database                              │
├─────────────────────────────────────────────────┤
│ データ | ルール | インデックス | 使用状況      │
├─────────────────────────────────────────────────┤
│                                                  │
│ コレクション一覧:                                │
│   ▶ blockedUsers                                │
│   ▶ favorites                                   │
│   ▶ parks                                       │
│   ▶ reports                                     │
│   ▶ reviews                                     │
│                                                  │
└─────────────────────────────────────────────────┘
```

---

## ステップ3: テスト公園データの削除

### 3-1. parksコレクションを開く

1. **「parks」** の行をクリック
2. 公園のドキュメント一覧が表示されます

### 3-2. テスト公園を見つける

各公園のドキュメントを確認します。以下の**すべての条件**に当てはまる公園がテストデータです：

#### ✅ テスト公園の特徴（以下のいずれかに該当）

1. **公園名がサンプルデータと一致**
   - 中央公園
   - 桜の森公園
   - こどもの森公園
   - 水と緑の広場
   - 展望台公園

2. **住所が架空**
   - 東京都千代田区丸の内**1-1-1**
   - 東京都港区六本木**1-1-1**
   - 東京都渋谷区神宮前**1-1-1**
   - 東京都新宿区新宿**1-1-1**
   - 東京都台東区上野**1-1-1**
   - （末尾が `1-1-1` の住所は架空です）

3. **userIdが sample-user で始まる**
   - `sample-user-1`
   - `sample-user-2`
   - `sample-user-3`
   - など

#### ❌ 本物の公園の特徴

以下の場合は**削除しないでください**：

1. **公園名が実在する**
   - Googleマップで検索すると実際に存在する公園

2. **住所が実在する**
   - 実際の住所（例: 東京都新宿区西新宿2-8-1）

3. **userIdが Firebase Auth の実際のUID**
   - 英数字のランダムな文字列（例: `xYz9AbC123dEf456`）
   - `sample-user-*` 以外

### 3-3. テスト公園を削除する

テスト公園を見つけたら、以下の手順で削除：

#### 方法1: ドキュメント詳細画面から削除

1. テスト公園のドキュメントIDをクリック
2. ドキュメントの詳細が表示されます：

   ```
   ┌─────────────────────────────────────────────┐
   │ ドキュメント: parks/abc123xyz               │
   ├─────────────────────────────────────────────┤
   │ フィールド          | 値                    │
   ├─────────────────────────────────────────────┤
   │ name (string)      | 中央公園               │
   │ address (string)   | 東京都千代田区丸の内... │
   │ description (string)| 都心にありながら...    │
   │ userId (string)    | sample-user-1          │
   │ ...                                         │
   │                                             │
   │ [⋮ 3点メニュー]                           │
   └─────────────────────────────────────────────┘
   ```

3. 右上の **「⋮」**（縦3点メニュー）をクリック
4. **「ドキュメントを削除」** を選択
5. 確認ダイアログが表示されます：

   ```
   ┌─────────────────────────────────────────────┐
   │ ドキュメントを削除                          │
   ├─────────────────────────────────────────────┤
   │ このドキュメントを削除してもよろしいです    │
   │ か？この操作は取り消せません。              │
   │                                             │
   │          [キャンセル]   [削除]             │
   └─────────────────────────────────────────────┘
   ```

6. 内容を再確認して、**「削除」** をクリック

#### 方法2: リスト画面から削除（より速い方法）

1. `parks` コレクションのリスト画面で
2. テスト公園の行の右端にマウスを置く
3. **「⋮」**（縦3点メニュー）が表示されます
4. クリックして **「ドキュメントを削除」** を選択
5. 確認ダイアログで **「削除」** をクリック

### 3-4. 残りのテスト公園も削除

同じ手順で、以下のテスト公園をすべて削除してください：

- [ ] 中央公園（東京都千代田区丸の内1-1-1）
- [ ] 桜の森公園（東京都港区六本木1-1-1）
- [ ] こどもの森公園（東京都渋谷区神宮前1-1-1）
- [ ] 水と緑の広場（東京都新宿区新宿1-1-1）
- [ ] 展望台公園（東京都台東区上野1-1-1）

**⚠️ 注意**: 削除する前に、必ず公園名・住所・userIdを確認してください！

---

## ステップ4: テストレビューの削除

### 4-1. reviewsコレクションを開く

1. 左側のパンくずリストで **「Firestore Database」** をクリック（コレクション一覧に戻る）
2. または、ブラウザの戻るボタンを押す
3. **「reviews」** コレクションをクリック

### 4-2. テストレビューを見つける

各レビューのドキュメントを確認します。

#### ✅ テストレビューの特徴

以下のいずれかに該当する場合、テストレビューです：

1. **userNameがサンプル名**
   - 田中太郎
   - 佐藤花子
   - 山田次郎
   - 高橋美咲
   - 鈴木一郎
   - 伊藤舞
   - 中村健太
   - 小林愛子
   - 渡辺真由美
   - 佐々木大輔
   - 松本優子
   - 加藤直樹
   - 木村由紀
   - 林浩二
   - 井上さくら

2. **userIdが sample-user で始まる**
   - `sample-user-1`
   - `sample-user-2`
   - など

3. **parkIdがテスト公園のIDと一致**
   - 先ほど削除したテスト公園のドキュメントIDと一致

#### ❌ 本物のレビューの特徴

以下の場合は**削除しないでください**：

1. **userNameが実際のユーザー名**
   - 上記のサンプル名以外

2. **userIdが Firebase Auth の実際のUID**
   - `sample-user-*` 以外

3. **commentが具体的で実際の体験に基づいている**

### 4-3. テストレビューを削除する

テスト公園と同じ手順で削除：

1. テストレビューのドキュメントを選択
2. 右上の **「⋮」** → **「ドキュメントを削除」**
3. 確認ダイアログで **「削除」**

### 4-4. すべてのテストレビューを削除

見つけたテストレビューをすべて削除してください。

**ヒント**: レビューの数が多い場合は、以下の方法で効率化できます：

1. ドキュメントをクリックして詳細を確認
2. `userName` フィールドの値を確認
3. サンプル名の場合は削除
4. 次のドキュメントへ

---

## ステップ5: テストお気に入りの削除（任意）

### 5-1. favoritesコレクションを開く

1. コレクション一覧に戻る
2. **「favorites」** コレクションをクリック

### 5-2. テストお気に入りを見つけて削除

#### ✅ テストお気に入りの特徴

- **userIdが sample-user で始まる**
  - `sample-user-1`
  - `sample-user-2`
  - など

#### 削除手順

1. 各ドキュメントの `userId` フィールドを確認
2. `sample-user-*` で始まる場合は削除
3. それ以外は**削除しない**

---

## ステップ6: テスト報告の削除（任意）

### 6-1. reportsコレクションを開く

1. コレクション一覧に戻る
2. **「reports」** コレクションをクリック（存在する場合）

### 6-2. テスト報告を見つけて削除

#### ✅ テスト報告の特徴

- **reportedBy または reportedUser が sample-user で始まる**
  - `sample-user-1`
  - `sample-user-2`
  - など

#### 削除手順

1. 各ドキュメントの `reportedBy` および `reportedUser` フィールドを確認
2. どちらかが `sample-user-*` で始まる場合は削除
3. それ以外は**削除しない**

---

## ステップ7: テストブロックユーザーの削除（任意）

### 7-1. blockedUsersコレクションを開く

1. コレクション一覧に戻る
2. **「blockedUsers」** コレクションをクリック（存在する場合）

### 7-2. テストブロックユーザーを見つけて削除

#### ✅ テストブロックユーザーの特徴

- **userId または blockedUserId が sample-user で始まる**
  - `sample-user-1`
  - `sample-user-2`
  - など

#### 削除手順

1. 各ドキュメントの `userId` および `blockedUserId` フィールドを確認
2. どちらかが `sample-user-*` で始まる場合は削除
3. それ以外は**削除しない**

---

## ステップ8: 削除後の確認

### 8-1. Firebase Consoleで確認

各コレクションを開いて、テストデータが削除されたことを確認：

#### parksコレクション

- [ ] 「中央公園」が削除されている
- [ ] 「桜の森公園」が削除されている
- [ ] 「こどもの森公園」が削除されている
- [ ] 「水と緑の広場」が削除されている
- [ ] 「展望台公園」が削除されている
- [ ] 本物の公園データは残っている

#### reviewsコレクション

- [ ] サンプル名（田中太郎、佐藤花子など）のレビューが削除されている
- [ ] `sample-user-*` のuserIdを持つレビューが削除されている
- [ ] 本物のユーザーのレビューは残っている

#### その他のコレクション

- [ ] `sample-user-*` のuserIdを持つデータがすべて削除されている

### 8-2. アプリで確認

1. ParkPediaアプリを起動
2. ホーム画面を確認
3. サンプル公園（中央公園、桜の森公園など）が**表示されない**ことを確認
4. 本物のユーザーが投稿した公園は**表示される**ことを確認

---

## 🔍 よくある質問

### Q1: どれがテストデータか分からない

**A**: 以下の特徴があればテストデータです：

1. **公園名**: 中央公園、桜の森公園、こどもの森公園、水と緑の広場、展望台公園
2. **住所**: 末尾が `1-1-1` の架空住所
3. **userId**: `sample-user-*` で始まる
4. **レビュー投稿者名**: 田中太郎、佐藤花子など

**不明な場合は削除しないでください**。安全第一です。

### Q2: 誤って本物のデータを削除してしまった

**A**: 残念ながら、削除したデータは復元できません。

- バックアップがあればリストア可能
- バックアップがない場合は復元不可
- ユーザーに再投稿を依頼するしかありません

### Q3: テストデータが多すぎて手動削除が大変

**A**: スクリプトでの一括削除をお勧めします。

```bash
node scripts/deleteTestData.js
```

詳しくは `FIREBASE_TEST_DATA_CLEANUP_GUIDE.md` を参照してください。

### Q4: 削除ボタンが見つからない

**A**: 以下を確認してください：

1. Firebase Consoleで、自分のアカウントに「編集者」または「オーナー」権限があるか確認
2. ドキュメントの詳細画面で、右上の **「⋮」**（縦3点メニュー）を探す
3. リスト画面で、各行の右端にマウスを置くとメニューが表示されます

### Q5: parksコレクションにテスト公園が見つからない

**A**: 以下の可能性があります：

1. **既に削除されている**: 過去に削除済みの可能性があります
2. **サンプルデータをインポートしていない**: テストデータがまだ追加されていない
3. **コレクション名が異なる**: `parks` 以外のコレクション名を使用している可能性

いずれの場合も、テストデータが存在しないのであれば削除作業は不要です。

---

## 📋 削除作業チェックリスト

作業を進めながら、以下をチェックしてください：

### 準備

- [ ] Firebase Consoleにログイン完了
- [ ] ParkPediaプロジェクトを開いた
- [ ] Firestore Databaseを開いた

### parksコレクション

- [ ] `parks` コレクションを開いた
- [ ] テスト公園を確認した
- [ ] 中央公園を削除した
- [ ] 桜の森公園を削除した
- [ ] こどもの森公園を削除した
- [ ] 水と緑の広場を削除した
- [ ] 展望台公園を削除した
- [ ] 本物の公園データが残っていることを確認した

### reviewsコレクション

- [ ] `reviews` コレクションを開いた
- [ ] テストレビューを確認した
- [ ] サンプル名のレビューを削除した
- [ ] `sample-user-*` のレビューを削除した
- [ ] 本物のレビューが残っていることを確認した

### その他のコレクション（任意）

- [ ] `favorites` コレクションのテストデータを削除した
- [ ] `reports` コレクションのテストデータを削除した（存在する場合）
- [ ] `blockedUsers` コレクションのテストデータを削除した（存在する場合）

### 最終確認

- [ ] Firebase Consoleですべてのコレクションを確認した
- [ ] アプリで動作確認した
- [ ] テスト公園が表示されないことを確認した
- [ ] 本物のデータが正常に表示されることを確認した

---

## ✅ 完了！

お疲れ様でした！テストデータの削除が完了しました。

次のステップ：

1. [ ] アプリで最終動作確認
2. [ ] TestFlightで確認
3. [ ] App Storeに提出
4. [ ] 正式リリース 🎉

---

**最終更新**: 2025年12月4日

**ご不明な点があれば、お気軽にお問い合わせください！**
