# 次のステップ - App Store レビュー対応

## ✅ 実装完了した機能

### 1. ✅ 利用規約（EULA）への同意機能
- **実装場所**: `parkpedia/screens/LoginScreen.js`
- **機能**: 
  - 新規登録時に利用規約への同意チェックボックスを表示
  - 同意しないとアカウント作成できない
  - 利用規約画面へのリンクあり
- **利用規約画面**: `parkpedia/screens/TermsOfServiceScreen.js`
  - 不適切なコンテンツへのゼロトレランスを明記
  - 24時間以内の対応を明記
  - ユーザーブロック機能についても記載

### 2. ✅ ユーザーブロック機能
- **実装場所**: `parkpedia/screens/ParkDetailScreen.js`
- **機能**:
  - レビューカードに「🚫 ブロック」ボタンを表示
  - ブロックしたユーザーのレビューは非表示になる
  - Firestoreの`blockedUsers`コレクションに保存
- **Firestoreルール**: `parkpedia/firestore.rules`に`blockedUsers`コレクションのルールを追加

### 3. ✅ アカウント削除機能（既存）
- **実装場所**: `parkpedia/screens/MyPageScreen.js`
- **機能**: 完全なアカウント削除が可能

### 4. ✅ コンテンツ報告機能（既存）
- **実装場所**: `parkpedia/screens/ParkDetailScreen.js`
- **機能**: レビューに「🚩 報告」ボタンあり

---

## 📋 次にすべきこと

### ステップ1: 実装の動作確認（重要）

#### 1-1. 利用規約への同意機能の確認
1. アプリを起動
2. ログイン画面で「新規登録」をタップ
3. 利用規約への同意チェックボックスが表示されることを確認
4. チェックを入れずにアカウント作成を試みる
   - ✅ エラーメッセージが表示されることを確認
5. チェックを入れてアカウント作成を試みる
   - ✅ アカウントが作成できることを確認
6. 「利用規約」リンクをタップ
   - ✅ 利用規約画面が表示されることを確認

#### 1-2. ユーザーブロック機能の確認
1. 公園詳細画面を開く
2. レビューセクションをスクロール
3. 他のユーザーのレビューに「🚫 ブロック」ボタンが表示されることを確認
4. 「🚫 ブロック」ボタンをタップ
   - ✅ 確認ダイアログが表示されることを確認
5. 「ブロック」を選択
   - ✅ ブロック成功メッセージが表示されることを確認
   - ✅ ブロックしたユーザーのレビューが非表示になることを確認

#### 1-3. アカウント削除機能の確認
1. マイページを開く
2. 「アカウントを削除」ボタンが表示されることを確認
3. ボタンをタップ（実際に削除はしない）
   - ✅ 確認ダイアログが表示されることを確認

#### 1-4. コンテンツ報告機能の確認
1. 公園詳細画面のレビューセクションを開く
2. 「🚩 報告」ボタンが表示されることを確認
3. ボタンをタップ
   - ✅ 確認ダイアログが表示されることを確認

---

### ステップ2: App Store Connectへの返信内容を更新

実装が完了したので、返信ドラフトを更新する必要があります。

**更新が必要な箇所**:
- 利用規約（EULA）への同意機能 → **実装済み**に変更
- ユーザーブロック機能 → **実装済み**に変更

---

### ステップ3: Firestoreルールのデプロイ

`firestore.rules`に`blockedUsers`コレクションのルールが追加されているので、Firebase Consoleにデプロイする必要があります。

**手順**:
1. Firebase Consoleにログイン
2. Firestore Database > Rules を開く
3. `parkpedia/firestore.rules`の内容をコピー＆ペースト
4. 「公開」をクリック

---

### ステップ4: テストビルドの作成

実装を確認したら、テストビルドを作成します。

**Expoの場合**:
```bash
cd parkpedia
eas build --platform ios --profile production
```

**または**:
```bash
expo build:ios
```

---

### ステップ5: App Store Connectへの返信

#### 5-1. 返信内容の準備

`APP_STORE_CONNECT_REPLY_DRAFT.md`を更新して、以下を反映：

1. **利用規約（EULA）への同意機能**
   - ✅ 実装済みであることを明記
   - 新規登録時に利用規約への同意が必要
   - 利用規約画面で不適切なコンテンツへのゼロトレランスを明記

2. **ユーザーブロック機能**
   - ✅ 実装済みであることを明記
   - レビューカードから直接ブロック可能
   - ブロックしたユーザーのコンテンツは非表示

#### 5-2. 返信の送信

1. App Store Connectにログイン
2. レビュー結果ページを開く
3. 「返信」ボタンをクリック
4. 更新した返信内容をコピー＆ペースト
5. 送信

---

### ステップ6: 新しいビルドの提出（必要に応じて）

レビュアーが追加の確認を要求する場合、または新しいビルドが必要な場合：

1. テストビルドを作成
2. App Store Connectにアップロード
3. レビューを提出

---

## 🎯 優先順位

### 🔴 最優先（今すぐ実施）

1. **実装の動作確認**
   - 利用規約への同意機能
   - ユーザーブロック機能
   - アカウント削除機能
   - コンテンツ報告機能

2. **Firestoreルールのデプロイ**
   - Firebase Consoleに`blockedUsers`コレクションのルールを追加

### 🟡 高優先度（今日中に実施）

3. **返信内容の更新**
   - `APP_STORE_CONNECT_REPLY_DRAFT.md`を更新

4. **App Store Connectへの返信**
   - 更新した返信内容を送信

### 🟢 中優先度（必要に応じて）

5. **テストビルドの作成**
   - レビュアーが要求した場合

6. **新しいビルドの提出**
   - レビュアーが要求した場合

---

## 📝 チェックリスト

### 実装確認
- [ ] 利用規約への同意機能が動作する
- [ ] ユーザーブロック機能が動作する
- [ ] アカウント削除機能が動作する
- [ ] コンテンツ報告機能が動作する

### Firestore設定
- [ ] FirestoreルールをFirebase Consoleにデプロイした
- [ ] `blockedUsers`コレクションのルールが正しく設定されている

### 返信準備
- [ ] `APP_STORE_CONNECT_REPLY_DRAFT.md`を更新した
- [ ] 返信内容が正確であることを確認した

### App Store Connect
- [ ] App Store Connectに返信を送信した
- [ ] デモアカウント情報を提供した

---

## 💡 重要な注意点

1. **デモアカウントの保護**
   - デモアカウント（`reviewer@parkpedia.test`）を削除しないでください
   - レビュアーがテストに使用します

2. **スクリーンショットの準備（オプション）**
   - 返信にスクリーンショットを添付すると、より明確に説明できます
   - 利用規約への同意画面
   - ユーザーブロックボタン
   - アカウント削除ボタン

3. **返信のトーン**
   - 丁寧で専門的なトーンを維持
   - 実装済みの機能を明確に説明
   - テスト手順を提供

---

## 📞 サポート

質問や問題がある場合：
- 実装の動作確認で問題が発生した場合
- Firestoreルールのデプロイで問題が発生した場合
- App Store Connectへの返信で不明な点がある場合

---

**最終更新**: 2025-11-25




