# 管理者ページ使用ガイド

## 📋 概要

管理者ページは、アプリのコンテンツを管理するための専用画面です。レポートの対応、公園・レビューの削除などが可能です。

---

## 🔐 アクセス方法

### 1. 管理者権限の確認
- マイページを開く
- 管理者権限がある場合、「🔧 管理者ページ」ボタンが表示されます
- ボタンをタップして管理者ページにアクセス

### 2. 管理者権限の設定（初回のみ）

#### Firebase Consoleで設定
1. **Firebase Consoleを開く**
   - https://console.firebase.google.com/project/parkpedia-app/firestore/data
   - ログインが必要な場合は、Googleアカウントでログイン

2. **Firestore Databaseを開く**
   - 左メニューから「Firestore Database」をクリック

3. **`admins`コレクションを作成**（まだ存在しない場合）
   - 「コレクションを開始」をクリック
   - コレクションID: `admins` を入力
   - 「次へ」をクリック

4. **管理者を追加**
   - ドキュメントID: **管理者のユーザーUID**（Firebase AuthenticationのUID）
   - フィールドを追加:
     - フィールド: `userId`
     - タイプ: `string`
     - 値: **管理者のユーザーUID**（ドキュメントIDと同じ）

#### ユーザーUIDの確認方法
1. Firebase Console > Authentication を開く
2. ユーザー一覧から管理者にしたいユーザーを選択
3. UIDをコピー

---

## 🎯 機能説明

### タブ切り替え
管理者ページには3つのタブがあります：
- **レポート**: ユーザーから報告されたレビューを管理（デフォルト）
- **公園**: すべての公園を管理
- **レビュー**: すべてのレビューを管理

---

## 📝 レポート管理

### レポートの状態
- **対応待ち** (pending): 新しく報告されたレビュー
- **解決済み** (resolved): 対応が完了したレポート
- **却下** (dismissed): 問題がないと判断したレポート

### 操作

#### 1. 解決済みにする
- **使用場面**: 不適切なコンテンツを削除した場合など
- **操作**: 「解決済み」ボタンをタップ
- **結果**: レポートの状態が「解決済み」に変更されます

#### 2. 却下する
- **使用場面**: 報告内容に問題がないと判断した場合
- **操作**: 「却下」ボタンをタップ
- **結果**: レポートの状態が「却下」に変更されます

#### 3. レビューを削除
- **使用場面**: 不適切なレビューを削除する場合
- **操作**: 「レビュー削除」ボタンをタップ
- **結果**: 
  - レビューが削除されます
  - 公園の評価が自動的に再計算されます
  - レポートも更新されます

### レポート情報
各レポートには以下の情報が表示されます：
- **状態**: 対応待ち / 解決済み / 却下
- **公園名**: 報告されたレビューの公園
- **理由**: 不適切なコンテンツ / スパム / ハラスメント / その他
- **レビュー内容**: 報告されたレビューの内容
- **評価**: レビューの星評価
- **投稿日**: レポートが作成された日付

---

## 🏞️ 公園管理

### 公園一覧
- すべての公園が作成日時の新しい順に表示されます
- 公園名、住所、評価、レビュー数が表示されます

### 操作

#### 公園を削除
- **注意**: 公園を削除すると、関連するすべてのレビューも削除されます
- **操作**: 「削除」ボタンをタップ → 確認ダイアログで「削除」を選択
- **結果**: 
  - 公園が削除されます
  - 関連するすべてのレビューが削除されます
  - レポートも更新されます

---

## ⭐ レビュー管理

### レビュー一覧
- すべてのレビューが投稿日時の新しい順に表示されます
- 公園名、評価、コメント、投稿日が表示されます

### 操作

#### レビューを削除
- **操作**: 「削除」ボタンをタップ → 確認ダイアログで「削除」を選択
- **結果**: 
  - レビューが削除されます
  - 公園の評価が自動的に再計算されます
  - レポートも更新されます

---

## ⚠️ 注意事項

### 削除操作について
- **取り消し不可**: 削除した公園やレビューは復元できません
- **関連データ**: 公園を削除すると、関連するすべてのレビューも削除されます
- **評価の更新**: レビューを削除すると、公園の評価が自動的に再計算されます

### 管理者権限について
- **最初の管理者**: Firebase Consoleから手動で追加する必要があります
- **追加の管理者**: 最初の管理者が他の管理者を追加できます
- **権限の確認**: 管理者権限がない場合、管理者ページにアクセスできません

---

## 🔧 トラブルシューティング

### 「管理者ページ」ボタンが表示されない
- **原因**: 管理者権限が設定されていない
- **解決方法**: Firebase Consoleで`admins`コレクションにユーザーUIDを追加

### レポートが表示されない
- **原因**: レポートが存在しない、または権限エラー
- **解決方法**: 
  - Firebase Consoleで`reports`コレクションを確認
  - Firestoreルールが正しくデプロイされているか確認

### 削除操作が失敗する
- **原因**: 権限エラー、またはネットワークエラー
- **解決方法**: 
  - インターネット接続を確認
  - Firestoreルールが正しくデプロイされているか確認
  - アプリを再起動

---

## 📞 サポート

問題が解決しない場合は、以下を確認してください：
1. Firebase Consoleでデータが正しく保存されているか
2. Firestoreルールが正しくデプロイされているか
3. アプリが最新バージョンか

